# select the last 100 burnin and last 100 post-burnin generations
run_allele_counts_last_100 <- run_allele_counts_grouped_meta %>%
group_by(config_id, bBurninMode) %>%
filter(generation >= max(generation) - 100)
# build mean allele counts and SD by config and mode for the last 100 generations
run_allele_counts_last_100_mean <- run_allele_counts_last_100 %>%
summarise(mean_alleles = mean(n), sd = sd(n), .groups = "keep")
run_host_data_last_gen_successful_presentation_dist <- run_host_data_combined_meta %>%
group_by(config_id, successful_presentations) %>%
filter(generation == max(generation)) %>%
mutate(successful_presentations_fac = as.factor(successful_presentations))
run_host_data_last_gen_successful_presentation_dist_plt <- ggplot(run_host_data_last_gen_successful_presentation_dist) +
aes(
x = config_id,
group = successful_presentations,
fill = successful_presentations_fac
) +
geom_bar(position = "dodge") +
theme_minimal()
run_host_data_last_gen_successful_presentation_dist_plt
run_host_data_last_gen_successful_presentation_dist_plt <- ggplot(run_host_data_last_gen_successful_presentation_dist) +
aes(
x = successful_presentations,
group = successful_presentations,
fill = successful_presentations_fac
) +
geom_bar(position = "dodge") +
theme_minimal()
run_host_data_last_gen_successful_presentation_dist_plt
run_host_data_last_gen_successful_presentation_dist <- run_host_data_combined_meta %>%
group_by(config_id, successful_presentations) %>%
filter(generation == max(generation)) %>%
mutate(successful_presentations_fac = as.factor(successful_presentations))
run_host_data_last_gen_successful_presentation_dist_plt <- ggplot(run_host_data_last_gen_successful_presentation_dist) +
aes(
x = config_id,
group = successful_presentations,
fill = successful_presentations_fac
) +
geom_bar(position = "dodge") +
theme_minimal()
run_host_data_last_gen_successful_presentation_dist_plt
run_host_data_last_gen_successful_presentation_dist_plt <- ggplot(run_host_data_last_gen_successful_presentation_dist) +
aes(
x = config_id,
group = successful_presentations,
fill = successful_presentations_fac
) +
geom_bar(position = "dodge") +
theme_minimal()
run_host_data_last_gen_successful_presentation_dist_plt
ggsave(file.path(output_dir, current_run_id, "host_presentation_counts.png"), plot = run_host_data_last_gen_successful_presentation_dist_plt, width = 3000, height = 3000, units = "px", bg = "#ffffff")
run_host_data_last_gen_successful_presentation_dist_plt
ggsave(file.path(output_dir, current_run_id, "host_presentation_counts.png"), plot = run_host_data_last_gen_successful_presentation_dist_plt, width = 3000, height = 1000, units = "px", bg = "#ffffff")
run_host_data_last_gen_successful_presentation_dist_plt
ggsave(file.path(output_dir, current_run_id, "host_presentation_counts.png"), plot = run_host_data_last_gen_successful_presentation_dist_plt, width = 3000, height = 1500, units = "px", bg = "#ffffff")
# successful antigen presentations in the last generation
run_host_data_last_gen_successful_presentation <- run_host_data_combined_meta %>%
group_by(config_id, successful_presentations) %>%
filter(generation == max(generation)) %>%
mutate(successful_presentations_fac = as.factor(successful_presentations))
run_host_data_last_gen_successful_presentation_dist_plt <- ggplot(run_host_data_last_gen_successful_presentation) +
aes(
x = config_id,
group = successful_presentations,
fill = successful_presentations_fac
) +
geom_bar(position = "dodge") +
theme_minimal()
run_host_data_last_gen_successful_presentation_dist_plt
ggsave(file.path(output_dir, current_run_id, "host_presentation_counts.png"), plot = run_host_data_last_gen_successful_presentation_dist_plt, width = 3000, height = 1500, units = "px", bg = "#ffffff")
# average fitness over time
run_host_data_fitness <- run_host_data_combined_meta %>%
filter(bBurninMode == FALSE) %>%
group_by(config_id) %>%
summarize(mean_fitness = mean(fitness), sd_fitness = sd(fitness))
View(run_host_data_fitness)
# average fitness over time
run_host_data_fitness <- run_host_data_combined_meta %>%
filter(bBurninMode == FALSE) %>%
group_by(config_id, generation) %>%
summarize(mean_fitness = mean(fitness), sd_fitness = sd(fitness))
## Allele counts
# get allele counts by config, generation and species
run_allele_counts = run_host_allele_data_combined %>% count(config_id, generation, species)
View(run_host_data_fitness)
View(run_config_common)
View(run_configs)
run_host_data_fitness_mean_over_time_plt <- ggplot(run_host_data_fitness_mean_over_time) +
aes(
x = generation,
y = mean_fitness,
group = as.factor(config_id),
color = as.factor(config_id)
) +
geom_abline(run_configs_common["hosts.fitness_minimum"]) +
geom_line() +
theme_minimal()
# average fitness over time
run_host_data_fitness_mean_over_time <- run_host_data_combined_meta %>%
filter(bBurninMode == FALSE) %>%
group_by(config_id, generation) %>%
summarize(mean_fitness = mean(fitness), sd_fitness = sd(fitness))
run_host_data_fitness_mean_over_time_plt <- ggplot(run_host_data_fitness_mean_over_time) +
aes(
x = generation,
y = mean_fitness,
group = as.factor(config_id),
color = as.factor(config_id)
) +
geom_abline(run_configs_common["hosts.fitness_minimum"]) +
geom_line() +
theme_minimal()
run_host_data_fitness_mean_over_time_plt <- ggplot(run_host_data_fitness_mean_over_time) +
aes(
x = generation,
y = mean_fitness,
group = as.factor(config_id),
color = as.factor(config_id)
) +
geom_abline(run_config_common["hosts.fitness_minimum"]) +
geom_line() +
theme_minimal()
run_host_data_fitness_mean_over_time_plt <- ggplot(run_host_data_fitness_mean_over_time) +
aes(
x = generation,
y = mean_fitness,
group = as.factor(config_id),
color = as.factor(config_id)
) +
geom_hline(yintercept =  run_config_common["hosts.fitness_minimum"]) +
geom_line() +
theme_minimal()
run_host_data_fitness_mean_over_time_plt
run_host_data_fitness_mean_over_time_plt <- ggplot(run_host_data_fitness_mean_over_time) +
aes(
x = generation,
y = mean_fitness,
group = config_id,
color = config_id
) +
geom_hline(yintercept =  run_config_common["hosts.fitness_minimum"]) +
geom_line() +
theme_minimal()
run_host_data_fitness_mean_over_time_plt
run_host_data_fitness_mean_over_time
run_host_data_fitness_mean_over_time_plt <- ggplot(run_host_data_fitness_mean_over_time) +
aes(
x = generation,
y = mean_fitness,
group = config_id,
color = config_id
) +
geom_hline(yintercept =  run_config_common["hosts.fitness_minimum"]) +
geom_point() +
theme_minimal()
run_host_data_fitness_mean_over_time_plt
run_config_common["hosts.fitness_minimum"]
run_config_common[1,"hosts.fitness_minimum"]
as.number(run_config_common[1,"hosts.fitness_minimum"])
as.numeric(run_config_common[1,"hosts.fitness_minimum"])
run_host_data_fitness_mean_over_time_plt <- ggplot(run_host_data_fitness_mean_over_time) +
aes(
x = generation,
y = mean_fitness,
group = config_id,
color = config_id
) +
geom_hline(yintercept = as.numeric(run_config_common[1,"hosts.fitness_minimum"])) +
geom_point() +
theme_minimal()
run_host_data_fitness_mean_over_time_plt
run_host_data_fitness_mean_over_time_plt <- ggplot(run_host_data_fitness_mean_over_time) +
aes(
x = generation,
y = mean_fitness,
group = config_id,
color = config_id
) +
geom_hline(yintercept = as.numeric(run_config_common[1,"hosts.fitness_minimum"])) +
geom_point() +
geom_line() +
theme_minimal()
run_host_data_fitness_mean_over_time_plt
source("C:/Users/Jan/projects/sim-analysis/prelim.R")
source("C:/Users/Jan/projects/sim-analysis/prelim.R")
library(plotly)
install.packages("plotly")
library(plotly)
plotly::ggplotly(run_host_data_last_gen_successful_presentation_dist_plt)
plotly::ggplotly(run_host_data_fitness_mean_over_time_plt)
library(cairo)
install.packages("Cairo")
library(cairo)
library(Cairo)
run_host_data_last_gen_successful_presentation_dist_plt
run_host_data_fitness_mean_over_time_plt
ggsave(file.path(output_dir, current_run_id, "host_fitness_mean.tiff"), plot = run_host_data_fitness_mean_over_time_plt, width = 3000, height = 1500, dpi = "retina", device = "tiff", type="cairo", units = "px")
plotly::ggplotly(run_host_data_fitness_mean_over_time_plt)
ggsave(file.path(output_dir, current_run_id, "host_fitness_mean.png"), plot = run_host_data_fitness_mean_over_time_plt, width = 3000, height = 1500, dpi = "retina", device = "png", type="cairo", units = "px")
ggsave(file.path(output_dir, current_run_id, "host_fitness_mean.png"), plot = run_host_data_fitness_mean_over_time_plt, width = 3000, height = 1500, dpi = "retina", device = "png", type="cairo", units = "px")
ggsave(file.path(output_dir, current_run_id, "host_fitness_mean.png"), plot = run_host_data_fitness_mean_over_time_plt, width = 3000, height = 1500, dpi = "retina", device = "png", type="cairo", units = "px", bg = "#fff")
ggsave(file.path(output_dir, current_run_id, "host_fitness_mean.png"), plot = run_host_data_fitness_mean_over_time_plt, width = 3000, height = 1500, dpi = "retina", device = "png", type="cairo", units = "px", bg = "#ffffff")
save_plot <- function(path, plt, width, height){
ggsave(path, plot = plt, width = width, height = height, dpi = "retina", device = "png", type="cairo", units = "px", bg = "#ffffff")
}
save_plot_defaults <- function(path, plt, width, height){
ggsave(path, plot = plt, width = width, height = height, dpi = "retina", device = "png", type="cairo", units = "px", bg = "#ffffff")
}
save_plot_defaults(file.path(output_dir, current_run_id, "host_presentation_counts.tiff"), run_host_data_last_gen_successful_presentation_dist_plt, width = 3000, height = 1500)
save_plot_defaults(file.path(output_dir, current_run_id, "host_presentation_counts.png"), run_host_data_last_gen_successful_presentation_dist_plt, width = 3000, height = 1500)
save_plot_defaults(file.path(output_dir, current_run_id, "host_presentation_counts.png"), run_host_data_last_gen_successful_presentation_dist_plt, 3000, 1500)
run_host_data_last_gen_successful_presentation_dist_plt
plotly::ggplotly(run_host_data_last_gen_successful_presentation_dist_plt)
save_plot_defaults(file.path(output_dir, current_run_id, "host_fitness_mean.png"), run_host_data_fitness_mean_over_time_plt, 3000, 1500)
save_plot_defaults(file.path(output_dir, current_run_id, "allele_counts_box.png"), run_allele_counts_last_100_box_plt, 3000, 3000)
save_plot_defaults(file.path(output_dir, current_run_id, "allele_counts_last_100_box.png"), run_allele_counts_last_100_box_plt, 3000, 3000)
save_plot_defaults(file.path(output_dir, current_run_id, "allele_counts.png"), run_allele_counts_plt, 5000, 5000)
run_allele_counts_plt
save_plot_defaults(file.path(output_dir, current_run_id, "allele_counts.png"), run_allele_counts_plt, 10000, 10000)
save_plot_defaults(file.path(output_dir, current_run_id, "allele_counts.png"), run_allele_counts_plt, 10000, 5000)
save_plot_defaults(file.path(output_dir, current_run_id, "allele_counts.png"), run_allele_counts_plt, 20000, 5000)
save_plot_defaults <- function(path, plt, width, height){
ggsave(path, plot = plt, width = width, height = height, dpi = "retina", device = "png", type="cairo", units = "pixels", bg = "#ffffff", limitsize = FALSE)
}
save_plot_defaults(file.path(output_dir, current_run_id, "allele_counts.png"), run_allele_counts_plt, 20000, 5000)
save_plot_defaults <- function(path, plt, width, height){
ggsave(path, plot = plt, width = width, height = height, dpi = "retina", device = "png", type="cairo", units = "px", bg = "#ffffff", limitsize = FALSE)
}
save_plot_defaults(file.path(output_dir, current_run_id, "allele_counts.png"), run_allele_counts_plt, 20000, 5000)
run_allele_counts_last_100_box_plt
run_host_data_fitness_mean_over_time_plt
run_host_data_last_gen_successful_presentation_dist_plt
run_allele_counts_last_100_box_plt
# boxplot of the allele counts of the last 100 generations by simulation mode
run_allele_counts_last_100_box_plt = ggplot(run_allele_counts_last_100) +
aes(
x = bBurninMode,
y = n,
facet=config_id
) +
geom_boxplot() +
geom_jitter(width = 0.2, aes(color = config_id)) +
theme_minimal() +
scale_y_continuous(breaks = seq(0, 1000, by = 10)) +
facet_wrap(
vars(config_id),
labeller=labeller(config_id = label_from_config_id)
)
run_allele_counts_last_100_box_plt
# read host genome data (allele ids of all host individuals)
run_host_genome_data = read_run_data(current_run_path, "host_genome_data.csv")
run_host_genome_data_combined = bind_rows(run_host_genome_data, .id = "config_id")
# heterozygosity
run_host_genome_data_combined_meta = add_data(run_host_genome_data_combined, run_meta_data_combined)
run_host_genome_zygosity = run_host_genome_data_combined_meta %>%
mutate(zygosity = case_when(
allele_1_id == allele_2_id ~ "homozygote",
allele_1_id != allele_2_id ~ "heterzygote"
))
View(run_host_genome_zygosity)
run_host_genome_zygosity = run_host_genome_data_combined_meta %>%
mutate(zygosity = case_when(
allele_1_id == allele_2_id ~ "homozygote",
allele_1_id != allele_2_id ~ "heterzygote"
)) %>%
group_by(config_id, generation, species, locus)
run_host_genome_zygosity = run_host_genome_data_combined_meta %>%
mutate(zygosity = case_when(
allele_1_id == allele_2_id ~ "homozygote",
allele_1_id != allele_2_id ~ "heterzygote"
)) %>%
group_by(config_id, generation, species, locus_id)
# average fitness over time
run_host_data_fitness_mean_over_time <- run_host_data_combined_meta %>%
filter(bBurninMode == FALSE) %>%
group_by(config_id, generation, species) %>%
summarize(mean_fitness = mean(fitness), sd_fitness = sd(fitness))
run_host_data_fitness_mean_over_time_plt <- ggplot(run_host_data_fitness_mean_over_time) +
aes(
x = generation,
y = mean_fitness,
group = config_id,
color = config_id
) +
geom_hline(yintercept = as.numeric(run_config_common[1,"hosts.fitness_minimum"])) +
geom_point() +
geom_line() +
theme_minimal()
run_host_data_fitness_mean_over_time_plt
plotly::ggplotly(run_host_data_fitness_mean_over_time_plt)
# successful antigen presentations in the last generation
run_host_data_last_gen_successful_presentation <- run_host_data_combined_meta %>%
group_by(config_id, species, successful_presentations) %>%
filter(generation == max(generation)) %>%
mutate(successful_presentations_fac = as.factor(successful_presentations))
run_host_data_last_gen_successful_presentation_dist_plt <- ggplot(run_host_data_last_gen_successful_presentation) +
aes(
x = config_id,
group = successful_presentations,
fill = successful_presentations_fac
) +
geom_bar(position = "dodge") +
theme_minimal()
run_host_data_last_gen_successful_presentation_dist_plt
run_host_genome_zygosity = run_host_genome_data_combined_meta %>%
mutate(zygosity = case_when(
allele_1_id == allele_2_id ~ "homozygote",
allele_1_id != allele_2_id ~ "heterzygote"
)) %>%
group_by(config_id, generation, species, locus_id) %>%
count(name = "n")
run_host_genome_zygosity = run_host_genome_data_combined_meta %>%
mutate(zygosity = case_when(
allele_1_id == allele_2_id ~ "homozygote",
allele_1_id != allele_2_id ~ "heterzygote"
)) %>%
group_by(config_id, generation, species, locus_id) %>%
add_count(name = "n") %>%
add_count(zygosity, name = "H0")
run_host_genome_zygosity = run_host_genome_data_combined_meta %>%
mutate(zygosity = case_when(
allele_1_id == allele_2_id ~ "homozygote",
allele_1_id != allele_2_id ~ "heterzygote"
)) %>%
group_by(config_id, generation, species, locus_id) %>%
add_count(name = "n") %>%
count(zygosity, name = "H0")
run_host_genome_zygosity = run_host_genome_data_combined_meta %>%
mutate(zygosity = case_when(
allele_1_id == allele_2_id ~ "homozygote",
allele_1_id != allele_2_id ~ "heterzygote"
)) %>%
group_by(config_id, generation, species, locus_id) %>%
add_count(name = "n") %>%
add_count(zygosity, name = "zygosity_count") %>%
mutate
run_host_genome_zygosity = run_host_genome_data_combined_meta %>%
mutate(zygosity = case_when(
allele_1_id == allele_2_id ~ "homozygote",
allele_1_id != allele_2_id ~ "heterzygote"
)) %>%
group_by(config_id, generation, species, locus_id) %>%
add_count(name = "n") %>%
add_count(zygosity, name = "zygosity_count")
run_host_genome_zygosity = run_host_genome_data_combined_meta %>%
mutate(zygosity = case_when(
allele_1_id == allele_2_id ~ "homozygote",
allele_1_id != allele_2_id ~ "heterzygote"
)) %>%
group_by(config_id, generation, species, locus_id) %>%
add_count(name = "n") %>%
add_count(config_id, generation, species, locus_id,zygosity, name = "zygosity_count")
run_host_genome_zygosity = run_host_genome_data_combined_meta %>%
mutate(zygosity = case_when(
allele_1_id == allele_2_id ~ "homozygote",
allele_1_id != allele_2_id ~ "heterzygote"
)) %>%
group_by(config_id, generation, species, locus_id) %>%
add_count(name = "n") %>%
count(zygosity, name = "zygosity_count")
run_host_genome_zygosity = run_host_genome_data_combined_meta %>%
mutate(zygosity = case_when(
allele_1_id == allele_2_id ~ "homozygote",
allele_1_id != allele_2_id ~ "heterzygote"
)) %>%
group_by(config_id, generation, species, locus_id) %>%
count(zygosity, name = "zygosity_count") %>%
pivot_wider(names_from = zygosity, values_from = zygosity_count)
run_host_genome_zygosity = run_host_genome_data_combined_meta %>%
mutate(zygosity = case_when(
allele_1_id == allele_2_id ~ "homozygote",
allele_1_id != allele_2_id ~ "heterzygote"
)) %>%
group_by(config_id, generation, species, locus_id) %>%
count(zygosity, name = "zygosity_count") %>%
pivot_wider(names_from = zygosity, values_from = zygosity_count) %>%
mutate(h0 = heterozygote/(homozygote+heterozygote))
run_host_genome_zygosity = run_host_genome_data_combined_meta %>%
mutate(zygosity = case_when(
allele_1_id == allele_2_id ~ "homozygous",
allele_1_id != allele_2_id ~ "heterozygous"
)) %>%
group_by(config_id, generation, species, locus_id) %>%
count(zygosity, name = "zygosity_count") %>%
pivot_wider(names_from = zygosity, values_from = zygosity_count) %>%
mutate(h0 = heterozygous/(homozygous+heterozygous))
# heterozygosity
run_host_genome_data_combined_meta = add_data(run_host_genome_data_combined, run_meta_data_combined)
run_host_genome_zygosity = run_host_genome_data_combined_meta %>%
mutate(zygosity = case_when(
allele_1_id == allele_2_id ~ "homozygous",
allele_1_id != allele_2_id ~ "heterozygous"
)) %>%
group_by(config_id, generation, species, locus_id) %>%
count(zygosity, name = "zygosity_count") %>%
pivot_wider(names_from = zygosity, values_from = zygosity_count) %>%
mutate(hobs = heterozygous/(homozygous+heterozygous))
run_host_genome_zygosity_plt = ggplot(run_host_genome_zygosity) +
aes(
x = generation,
y = hobs,
group = as.factor(config_id),
color = as.factor(config_id)
) +
geom_line() +
theme_minimal()
run_host_genome_zygosity_plt
run_host_genome_zygosity_plt = ggplot(run_host_genome_zygosity) +
aes(
x = generation,
y = hobs,
group = config_id,
color = as.factor(config_id)
) +
geom_line() +
theme_minimal()
run_host_genome_zygosity_plt
run_host_genome_zygosity_plt = ggplot(run_host_genome_zygosity) +
aes(
x = generation,
y = hobs,
group = config_id,
color = config_id
) +
geom_line() +
theme_minimal()
run_host_genome_zygosity_plt
View(run_config_summary)
run_host_genome_zygosity_plt = ggplot(run_host_genome_zygosity) +
aes(
x = generation,
y = hobs,
group = config_id,
color = config_id
) +
geom_line() +
geom_vline(xintercept = run_config_summary[config_id,"burnin_generations"]) +
theme_minimal()
run_host_genome_zygosity_plt = ggplot(run_host_genome_zygosity) +
aes(
x = generation,
y = hobs,
group = config_id,
color = config_id
) +
geom_line() +
geom_vline(xintercept = run_config_common[1,"burnin_generations"]) +
theme_minimal()
run_host_genome_zygosity_plt
run_host_genome_zygosity_plt = ggplot(run_host_genome_zygosity) +
aes(
x = generation,
y = hobs,
group = config_id,
color = config_id
) +
geom_line() +
geom_vline(xintercept = as.numeric([1,"burnin_generations"])) +
theme_minimal()
run_host_genome_zygosity_plt
run_host_genome_zygosity_plt = ggplot(run_host_genome_zygosity) +
aes(
x = generation,
y = hobs,
group = config_id,
color = config_id
) +
geom_line() +
geom_vline(xintercept = as.numeric(run_config_common[1,"burnin_generations"])) +
theme_minimal()
run_host_genome_zygosity_plt
View(run_host_allele_data_combined)
test = left_join(run_host_genome_data_combined_meta, run_host_allele_data_combined, by = c("config_id", "generation", "species", "locus_id", "allele_id"))
test = left_join(run_host_genome_data_combined_meta, run_host_allele_data_combined, by = c("config_id", "generation", "species", "locus_id","allele_1_id" = "allele_id"))
View(test)
test = left_join(run_host_genome_data_combined_meta, run_host_allele_data_combined, by = c("config_id", "generation", "species", "locus_id","allele_1_id" = "allele_id"), suffix = c("1"))
test = left_join(run_host_genome_data_combined_meta, run_host_allele_data_combined, by = c("config_id", "generation", "species", "locus_id","allele_1_id" = "allele_id"), suffix = c("1", "2"))
test = left_join(run_host_genome_data_combined_meta, run_host_allele_data_combined,
by = c("config_id", "generation", "species", "locus_id","allele_1_id" = "allele_id"),
suffix = c(".x", ".y"))
test2 = left_join(test, run_host_allele_data_combined,
by = c("config_id", "generation", "species", "locus_id","allele_1_id" = "allele_id"),
suffix = c(".x", ".y"))
View(test2)
test = left_join(run_host_genome_data_combined_meta, run_host_allele_data_combined,
by = c("config_id", "generation", "species", "locus_id","allele_1_id" = "allele_id"),
suffix = c(".x", ".y"))
test2 = left_join(test, run_host_allele_data_combined,
by = c("config_id", "generation", "species", "locus_id","allele_2_id" = "allele_id"),
suffix = c(".x", ".y"))
test = run_host_genome_data_combined_meta %>%
left_join(run_host_genome_data_combined_meta, run_host_allele_data_combined,
by = c("config_id", "generation", "species", "locus_id","allele_1_id" = "allele_id"),
suffix = c(".x", ".y")) %>%
left_join(run_host_allele_data_combined,
by = c("config_id", "generation", "species", "locus_id","allele_2_id" = "allele_id"),
suffix = c(".allele_1", ".allele_2"))
test = run_host_genome_data_combined_meta %>%
left_join(run_host_allele_data_combined,
by = c("config_id", "generation", "species", "locus_id","allele_1_id" = "allele_id"),
suffix = c(".x", ".y")) %>%
left_join(run_host_allele_data_combined,
by = c("config_id", "generation", "species", "locus_id","allele_2_id" = "allele_id"),
suffix = c(".allele_1", ".allele_2"))
run_host_genome_data_combined_meta_count_freq = run_host_genome_data_combined_meta %>%
left_join(run_host_allele_data_combined,
by = c("config_id", "generation", "species", "locus_id","allele_1_id" = "allele_id"),
suffix = c(".allele_1", ".allele_2")) %>%
left_join(run_host_allele_data_combined,
by = c("config_id", "generation", "species", "locus_id","allele_2_id" = "allele_id"),
suffix = c(".allele_1", ".allele_2"))
